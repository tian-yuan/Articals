### 一种基于gossip通信协议的高安全性的去中心化的分布式服务发现方法及系统

#### 提供去中心化安全通信方式

*   当前
*   系统初始阶段存在一个或者多个可信节点，这里选择三个节点，这些节点成为种子节点seed node；
*   从seed处获取公钥，由于seed是可靠的，所以获取到的公钥也是可靠的；
*   不同的seed产生的公钥是不同的, 加入的节点保存节点对应的公钥的列表；
*   每个节点都产生自己的公钥；
*   每个节点每隔一段定期时间+随机时间更新公钥信息，并对老的公钥保存一定的过期时间；
*   步骤一，

*   如果系统中的大部分节点认为某个节点异常，或者可能是攻击节点，

* 定义通信的数据格式
1.数据以二进制或者json等文本格式通信；
2.每次通信都要携带公钥和加密后的数据；
3.


#### 技术领域

本发明涉及软件工程领域，具体的说是一种基于gossip协议的高安全性去中心化的分布式服务发现方法及系统

#### 背景技术

随着互联网技术的飞速发展，服务的规模也越来越大，特别的，随着微服务架构的发展，企业应用越来越多的把运行在同一个应用中的服务垂直拆分为多个
独立的子服务，子服务的粒度越来越小，部署的实例数越来越多，同时为了充分利用服务资源，在流量高峰期时进行动态扩容，在流量降低时进行缩容，
这最终导致微服务之间的服务发现和服务自治越来越困难；
服务在动态调整过程中，服务的数量和行为都会相应的改变，服务随时会加入或者退出整个系统，一般的做法是使用一个服务注册中心，
实现服务的自动注册和自动发现，但这种方法存在对注册中心的依赖，无法有效的做到一个服务自治。同时为了保证服务之间安全通信，缺乏一种安全的且轻量级的
方法

#### 发明内容
本发明针对当前技术发展的不足之处，提供了一种基于gossip协议的高安全的，轻量级的分布式服务发现且服务自治的方法及系统。
本发明所述一种基于gossip协议的高安全性，轻量级的分布式服务发现且服务自治的方法及系统，具体的解决上述技术问题的方案如下：
使用gossip反墒协议，实现服务自发现，实现服务之间的最终一致性；在此基础上提出动态生成公钥及私钥，节点之间动态的进行安全加密及认证
的方式，实现节点之间的高安全性；与已有技术相比，此方案安全性高，不依靠任何第三方中间件，完全去中心化，完全做到服务自治，在有限的时间内
实现服务发现；

实现基于gossip协议的高安全性去中心化的分布式服务发现方法及系统的具体过程包括如下步骤：
第一、初始化系统，系统初始化若干种子节点，种子节点的数量要大于或者等于一个；每个服务在加入整个系统时需要指定种子节点；
第二、当一个节点加入到整个系统时，指定种子节点；
第三、系统中的节点每隔一段指定的时间，随机选择已知的节点中的一个节点进行通信，通信流程如图1所示；
第四、根据gossip协议的收敛性证明，在log(n)时间后，每个节点都会获取到所有节点提供服务的(version, service, ip, port)列表信息，其中service是提供服务的名称；

所述的图1通信流程具体为：
Node1连接Node2，发送自身的公钥；
Node2保存node1的公钥；
Node2使用Node1的公钥加密格式化的自身已知的其他节点提供服务的(version, service, ip, port)列表信息；
Node1保存Node2的公钥，同时使用自身的私钥解密消息负载内容，如果解析失败，如图所示；如果解析成功，根据version保存最新的提供服务的(version, service, ip, port)列表信息；
Node1使用Node2的公钥，加密自身已知的其他节点提供服务的(version, service, ip, port)列表信息，协同自身的公钥发送给node2，为了保证密钥不被破解，在一定的随机时间后，节点可以更新自身的公钥和私钥对；
Node2保存Node1的公钥，同时使用自身的私钥解密消息负载内容，如果解析失败，如图2所示；如果解析成功，根据version保存最新的提供服务的(version, service, ip, port)列表信息；
此时经过三次交互，Node1和Node2均获取到对方的已知的根据version保存最新的提供服务的(version, service, ip, port)列表信息；
根据gossip协议的收敛性，在log(n)时间后，每个节点都会获取到所有节点提供服务的根据version保存最新的提供服务的(version, service, ip, port)列表信息；访问任何其中一个节点都可以获取整个系统的服务列表，从而实现高安全性的服务发现。

所述的图2，如果解析失败的处理流程具体如下：
节点接收到其他节点的消息；
使用消息解密消息内容；
如果解析失败或者解析出来的内容格式异常或者错误；
把节点对应的信息加入黑名，在一定时间内不响应对应节点的任何信息；
一定时间后清除此节点的黑名单信息，重新处理请求；











