### 一种使用gossip协议的自适应的负载均衡任务调度方法或者系统

#### 技术领域

本发明涉及软件工程领域，具体的说是一种使用gossip协议的自适应的负载均衡任务调度方法或者系统

#### 背景技术

面对大量用户访问、高并发请求，海量数据，可以使用高性能的服务器、大型数据库，存储设备，高性能Web服务器，采用高效率的编程语言等，
当单机容量达到极限时，我们需要考虑业务拆分和分布式部署，来解决大型网站访问量大，并发量高，海量数据的问题。当采用分布式部署时，
几乎所有的系统都需要架设负载均衡系统，当前使用的负载均衡包括DNS负载均衡、HTTP负载均衡、IP负载均衡、链路层负载均衡、混合型负载均衡等，
另外还有使用硬件负载均衡的，纵观所有负载均衡方法及设施，均需要部署负载均衡节点实现负载的分发，致使负载均衡器的性能成为系统的瓶颈；

#### 发明内容
本发明针对当前技术发展的不足之处，提供了一种使用gossip协议的自适应的负载均衡任务调度方法或者系统，实现一个去中心化的、自适应的、可以自动扩容及
缩容的负载均衡调度系统；

本发明解决其技术问题，采用的技术方案是：去中心化、自适应负载均衡方法、动态扩容及缩容，其特征在于，包括以下步骤：
步骤1、系统由一系列节点组成集群，各节点有一个gossip通信端口、一个任务调度端口和一个管理端口，每个节点由gossip通信模块负责信息交互，任务调度模块用于任务调度处理，
管理模块向外提供整个系统的负载信息查询及相关信息配置，配置信息会通过gossip通信模块传导到整个系统；
步骤2、集群通过gossip协议进行通信，互相交互各节点的任务调度端口和管理端口；
步骤3、各节点每隔一段时间计算各自节点的负载指标，具体负载指标计算如下：
步骤3.0、计算节点一段时间（此时间间隔可以通过管理节点进行配置）的平均cpu使用率，节点每隔一秒对系统cpu使用率进行采样，一段时间后，对cpu使用率求平均值C-mean；
步骤3.1、计算节点一段时间的平均内存使用率，节点每隔一秒对系统memory使用率进行采样，一段时间后，对memory使用率求平均值M-mean；
步骤3.2、计算节点一段时间的平均网络带宽使用率，节点每隔一秒对系统网络带宽使用率进行采样，一段时间后，对网络带宽使用率求平均值N-mean；
步骤3.3、节点更新gossip状态；
步骤4、集群中各节点定时通过gossip协议交互cpu使用率、内存使用率、网络带宽使用率等负载信息；
步骤5、集群某个节点接收到外部请求，根据集群中负载情况和连接情况，选择对应负载指标最低的节点向任务调度端口分发任务；
步骤6、管理节点每隔一段时间随机选取集群中的一个节点，获取整个系统的负载信息，如果发现整个系统负载持续过高，进行扩容，如果整个系统负载持续非常小，进行缩容，如图二：
步骤6.0、管理节点随机选取集群中的一个节点；
步骤6.1、管理节点通过REST接口从节点获取集群所有节点的负载情况；
步骤6.2、管理节点判断集群如果三分之二以上节点处在负载最大阈值以上运行，管理节点通过ansible操作物理机对服务进行扩容；
步骤6.3、管理节点判断集群如果三分之二以上节点处在负载最小阈值以下运行，管理节点通过ansible操作物理机对服务进行缩容；
步骤6.4、新加入的节点通过gossip协议与其他节点进行通信，从而加入调度集群；
步骤6.5、节点从集群中移除，系统在gossip协议通信下感知到节点的退出，之后的任务将不会再分配到被移除的节点；






